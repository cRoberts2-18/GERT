{% extends "layout.html" %}
{% block content %}


    
<div id="mySidebar" class="sidebar">
	
	
	<h2>API Data Request</h2><br>
	<label for="datastoreName">Data Store Name:</label><br>
	<select name = "datastoreName" id="datastoreName" >
            <option value = "cams-global-atmospheric-composition-forecasts" selected>cams-global-atmospheric-composition-forecasts</option>
        </select>
	<br>
	
		<label for="datepicker1">Date Start:   </label>&emsp;&emsp;<label for="datapicker2">   Date End:</label><br>
	<input type="date" id="datepicker1">&emsp;<input type="date" id="datepicker2"><br><br>
	
	<label for="time">Time Interval:</label><br>
	<select name = "time" id="time" >
            	<option value = "00:00" selected>00:00</option>
		<option value = "12:00" selected>12:00</option>
        </select>
	<br>

	
	<label>Variables for the chosen data</label><br>
	<div class="multiselect">
    	<div class="selectBox" onclick="showCheckboxes()">
      		<select id="select">
			<option>Select and Option</option>
      		</select>
      	<div class="overSelect"></div>
    	</div>
    	<div id="checkboxes">
      	<label for="one">
        	<input type="checkbox" id="one" />Carbon Monoxide</label>
      	<label for="two">
        	<input type="checkbox" id="two" />Carbon Dioxide</label>
      	<label for="three">
        	<input type="checkbox" id="three" />Nitrogen Dioxide</label>
	<label for="four">
        	<input type="checkbox" id="four" />Sulphur Dioxide</label>
    </div>
  </div>
	<br>
	
	<label for="leadtimeHour">Leadtime Hour:</label><br>
	<select name = "leadtimeHour" id="leadtimeHour" >
            	<option value = "0" selected>0</option>
		<option value = "1" selected>1</option>
        </select>

	<br><br>

	<label for="fileFormat">File Format:</label><br>
	<select name = "fileFormat" id="fileFormat" >
            <option value = "grib" selected>.grib</option>
        </select>
	<br><br>
	
	<label for="fileName">Chosen File Name:</label><br>
	<input type="text" id="fileName" name="fileName"><br><br>
	
	<input class="buttonstyle" type=button id = "makeCall" value = "Make API Request">
	
    	
   
  </div>
  
  <div id="main">
    <button class="openbtn" id="sideButton" onclick="openNav()"><i class="fa fa-caret-right"></i></button>
    
  <div id="map" class='map'></div>	
	  
  </div>
  
  <div class="home">
  <script>
    var expanded = false;

    function showCheckboxes() {
  	var checkboxes = document.getElementById("checkboxes");
  	if (!expanded) {
   		checkboxes.style.display = "block";
    		expanded = true;
  	} else {
    		checkboxes.style.display = "none";
    		expanded = false;
  	}
     }
	  
	  
	  
    function notifyMessage(msg,styles){
                 $.notify(msg,{
                 className: styles,
                 globalPosition: 'right center'
                        
                 });
     }
        
    
        var map = L.map('map',{
        center: [52.770775, -1.2043467],
        zoom: 15,
        zoomControl: false
	    
    });
    L.control.zoom({position: 'topright'}).addTo(map);
    
        L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
    }).addTo(map);
    
        function onMapClick(e) {
        notifyMessage("You clicked the map at " + e.latlng, "info");
    }
    
    map.on('click', onMapClick);
    
    $(function() {
      $("#SignOut").click(function () {
          $.ajax({
              url: 'GERTLogout.php',
              success: function(data) {
                 window.location.href = 'GertLogin.php';
                }
    });
    });
    });
	
	$(function() {
      $("#one").click(function () {
	      var $str = "";
	      if($("#one").is(":checked")){
		      	$str=$str.concat("CO ");
	      }	
		      
	      if($("#two").is(":checked")){
		      	$str=$str.concat("CO2 ");
	      }	
		      
	      if($("#three").is(":checked")){
		      	$str=$str.concat("NO2 ");
	      }	
		      
	      if($("#four").is(":checked")){
		      	$str=$str.concat("SO2 ");
	      }	
	      if($str==""){
	      var $str = "Select an option";
	      }
	      $("#select").find("option:selected").text($str);
	      
	      
      		
      });
});  

	  $(function() {
      $("#two").click(function () {
	      var $str = "";
	      if($("#one").is(":checked")){
		      	$str=$str.concat("CO ");
	      }	
		      
	      if($("#two").is(":checked")){
		      	$str=$str.concat("CO2 ");
	      }	
		      
	      if($("#three").is(":checked")){
		      	$str=$str.concat("NO2 ");
	      }	
		      
	      if($("#four").is(":checked")){
		      	$str=$str.concat("SO2 ");
	      }	
	      if($str==""){
	      var $str = "Select an option";
	      }
	      $("#select").find("option:selected").text($str);
	      
	      
      		
      });
});  

	  $(function() {
      $("#three").click(function () {
	      var $str = "";
	      if($("#one").is(":checked")){
		      	$str=$str.concat("CO ");
	      }	
		      
	      if($("#two").is(":checked")){
		      	$str=$str.concat("CO2 ");
	      }	
		      
	      if($("#three").is(":checked")){
		      	$str=$str.concat("NO2 ");
	      }	
		      
	      if($("#four").is(":checked")){
		      	$str=$str.concat("SO2 ");
	      }	
	      if($str==""){
	      var $str = "Select an option";
	      }
	      $("#select").find("option:selected").text($str);
	      
	      
      		
      });
});  

	  $(function() {
      $("#four").click(function () {
	      var $str = "";
	      if($("#one").is(":checked")){
		      	$str=$str.concat("CO ");
	      }	
		      
	      if($("#two").is(":checked")){
		      	$str=$str.concat("CO2 ");
	      }	
		      
	      if($("#three").is(":checked")){
		      	$str=$str.concat("NO2 ");
	      }	
		      
	      if($("#four").is(":checked")){
		      	$str=$str.concat("SO2 ");
	      }	
	      if($str==""){
	      var $str = "Select an option";
	      }
	      $("#select").find("option:selected").text($str);
	      
	      
      		
      });
});  

	  
	  
	  
	  
	  
	$(function() {
		$("#makeCall").click(function () {
			var $datastoreName = $("#datastoreName").val(); 
    			var $datepicker1 = $("#datepicker1").val(); 
			var $datepicker2 = $("#datepicker2").val();
			var $time = $("#time").val();
			var $variables = $('#variables').val();
			var $carbonMonoxide = $("#one").is(":checked");
			var $nitrogenDioxide = $("#three").is(":checked");
			var $sulphurDioxide = $("#four").is(":checked");
			var $carbonDioxide = $("#two").is(":checked");
			var $leadtimeHour = $("#leadtimeHour").val();
			var $fileName = $("#fileName").val();
			var $fileFormat = $("#fileFormat").val();
    	   	$.ajax({
    			method: "POST",
      			url: "{{ url_for('processAPICall')}}",
			data: {datastoreName:$datastoreName , datepicker1:$datepicker1, datepicker2:$datepicker2, time:$time, variables:$variables, carbonmonoxide:$carbonMonoxide,
			      nitrogendioxide:$nitrogenDioxide, sulphurdioxide:$sulphurDioxide, carbondioxide:$carbonDioxide,
			       leadtimeHour:$leadtimeHour, fileName:$fileName , fileFormat:$fileFormat},
      			
   		})
		.done(function(msg) {
		alert(msg)
		})   
		.fail(function(msg){
			alert("Error");
		});
		});
 
	});
      
    /* Set the width of the sidebar to 250px and the left margin of the page content to 250px */
    function openNav() {
      document.getElementById("mySidebar").style.width = "550px";
      document.getElementById("main").style.marginLeft = "550px";
      document.getElementById("sideButton").innerHTML="<i class=\"fa fa-caret-left\"></i>";
      document.getElementById("sideButton").setAttribute( "onClick", "javascript: closeNav();" );
    }
    
    /* Set the width of the sidebar to 0 and the left margin of the page content to 0 */
    function closeNav() {
      document.getElementById("mySidebar").style.width = "0";
      document.getElementById("main").style.marginLeft = "0";
      document.getElementById("sideButton").innerHTML="<i class=\"fa fa-caret-right\"></i>";
      document.getElementById("sideButton").setAttribute( "onClick", "javascript: openNav();" );
    }
    </script>
{% endblock %}

